var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,a=(e,a)=>{for(var c in a||(a={}))t.call(a,c)&&s(e,c,a[c]);if(n)for(var c of n(a))r.call(a,c)&&s(e,c,a[c]);return e};import{j as c,r as l,I as o,a as u,b as i,c as m,d,e as f,f as E,g as h,h as p,i as g}from"./vendor.ede28cba.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const r=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const c=new URL(e,r);if(self[t].moduleMap[c])return n(self[t].moduleMap[c]);const l=new Blob([`import * as m from '${c}';`,`${t}.moduleMap['${c}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){a(new Error(`Failed to import: ${e}`)),s(o)},onload(){n(self[t].moduleMap[c]),s(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("assets/");var b,S;function w(e){const t=new c("SHA-256","TEXT");return t.update(e),t.getHash("BYTES")}(S=b||(b={})).OK="ok",S.ERROR="error";let v=1;class y extends class{constructor(){this.listeners={}}on(e,t){const n=this.listeners[e]||[];return this.listeners[e]=[...n,t],()=>{this.off(e,t)}}off(e,t){const n=this.listeners[e]||[];this.listeners[e]=n.filter((e=>e!==t))}emit(e,t){(this.listeners[e]||[]).forEach((e=>e(t)))}destroy(){this.listeners={}}}{constructor(){super(...arguments),this.messageCallbacks={}}connect(e="localhost:4444",t=""){const n=this;return new Promise((function(r,s){n.ws=new WebSocket(`ws://${e}`),n.ws.onopen=()=>{n.send("GetAuthRequired",{},(function(e){const a=t+e.salt,c=btoa(w(a)),l=btoa(w(c+e.challenge));n.send("Authenticate",{auth:l},(e=>{e.status===b.ERROR&&s(e.error),r()}))}))},n.ws.onerror=e=>{s(e),n.emit("Error",e)},n.ws.onmessage=e=>{const t=JSON.parse(e.data),r=n.messageCallbacks[t["message-id"]];r&&r(t),t["update-type"]&&n.emit(t["update-type"],t)}}))}on(e,t){return super.on(e,t)}send(e,t,n){const r=v++;n&&(this.messageCallbacks[r]=n),this.ws.send(JSON.stringify(a({"request-type":e,"message-id":r.toString()},t)))}destroy(){this.ws.close(),super.destroy()}}const C=l.createContext({scenes:[],obsRef:{current:new y},currentScene:""});function R(e,t){var n,r;let s=(null==(n=function(e){return l.useContext(C).scenes.find((t=>t.name===e))}(e))?void 0:n.sources)||[];return t&&(s=(null==(r=s.find((e=>e.name===t)))?void 0:r.groupChildren)||[]),s}function j(){return l.useContext(C).obsRef.current}function N({children:e,hostname:t,password:n}){const[r,s]=l.useState([]),[a,c]=l.useState(""),o=l.useRef(new y);return l.useEffect((function(){const e=o.current,r=e=>{c(e["scene-name"])};return e.connect(t,n).then((()=>{e.send("GetSceneList",{},(e=>{s(e.scenes),c(e["current-scene"])}))})),e.on("SwitchScenes",r),()=>{e.off("SwitchScenes",r)}}),[]),l.createElement(C.Provider,{value:{scenes:r,obsRef:o,currentScene:a}},e)}function O({children:e}){return l.createElement("div",{className:"grid"},e)}var k,x,P,M;function T(e){var{color:s=k.grey,children:c}=e,o=((e,s)=>{var a={};for(var c in e)t.call(e,c)&&s.indexOf(c)<0&&(a[c]=e[c]);if(null!=e&&n)for(var c of n(e))s.indexOf(c)<0&&r.call(e,c)&&(a[c]=e[c]);return a})(e,["color","children"]);const u=s!==k.grey?{background:`var(--${s})`}:void 0;return l.createElement("button",a({className:`button is-${s}`,style:u},o),c)}function L({name:e}){switch(e){case P.scene:return l.createElement(p,null);case P.sound:return l.createElement(h,null);case P.music:return l.createElement(E,null);case P.tchat:return l.createElement(f,null);case P.zoom:return l.createElement(d,null);case P.left:return l.createElement(m,null);case P.right:return l.createElement(i,null);case P.camera:return l.createElement(u,null);case P.refresh:return l.createElement(o,null)}return null}function F({ignore:e="ðŸ“¦"}){const t=l.useContext(C).scenes;return l.createElement(l.Fragment,null,t.filter((t=>!t.name.startsWith(e))).map((e=>l.createElement(U,{key:e.name,scene:e.name}))))}function U({scene:e}){const t=l.useContext(C).currentScene,n=j();return l.createElement(T,{color:t===e?k.blue:void 0,onClick:()=>{n.send("SetCurrentScene",{"scene-name":e})}},l.createElement(L,{name:P.scene}),l.createElement("span",null,e))}(x=k||(k={})).blue="blue",x.red="red",x.yellow="yellow",x.purple="purple",x.green="green",x.grey="grey",(M=P||(P={})).scene="scene",M.sound="sound",M.music="music",M.tchat="tchat",M.zoom="zoom",M.left="left",M.right="right",M.camera="camera",M.refresh="refresh";const $={"C'est nul":"assets/cest-nul.3d0c5824.jpg",Travail:"assets/travail.5d4d612e.jpg","Travail termine":"assets/travail.5d4d612e.jpg","ah !":"assets/denis.00354ae5.jpg",sad:"assets/sad.29e5cf6c.jpg",Ascenseur:"assets/elevator.ca4ce089.jpg"};function z({scene:e,group:t,icon:n}){const r=R(e,t);return l.createElement(l.Fragment,null,r.map((e=>l.createElement(A,{name:e.name,key:e.name,icon:n}))))}function A({name:e,icon:t=P.sound}){const n=j(),[r,s]=l.useState(!1);l.useEffect((()=>{const t=n.on("MediaRestarted",(t=>{t.sourceName===e&&s(!0)})),r=n.on("MediaEnded",(t=>{t.sourceName===e&&(s(!1),n.send("SetSceneItemProperties",{item:e,visible:!1}))}));return()=>{t(),r()}}));const a=$[e];return l.createElement(T,{color:r?k.green:k.purple,onClick:()=>{n.send("SetSceneItemProperties",{item:e,visible:!r})}},l.createElement(L,{name:t}),l.createElement("span",null,e),l.createElement("img",{src:a,alt:""}))}function I({scene:e,filters:t=["show","hide"],children:n,colors:r=[k.blue,k.grey]}){const[s,a]=l.useState(0),c=j();return l.createElement(T,{color:r[s],onClick:()=>{const n=s+1>=t.length?0:s+1;c.send("SetSourceFilterVisibility",{sourceName:e,filterName:t[n],filterEnabled:!0}),a(n)}},n)}function _({scene:e,filter:t,children:n}){const r=j(),[s,a]=l.useState(!1);return l.useEffect((()=>r.on("SourceFilterVisibilityChanged",(n=>{n.sourceName===e&&n.filterEnabled&&a(n.filterName===t)}))),[t]),l.createElement(T,{color:s?k.green:k.blue,onClick:()=>{r.send("SetSourceFilterVisibility",{sourceName:e,filterName:t,filterEnabled:!s})}},n)}function B(){const e=j();return l.useEffect((()=>{e.on("TransitionEnd",(t=>{"Stream"===t["to-scene"]?e.send("SetCurrentTransition",{"transition-name":"Move"}):["Soon","Pause",""].includes(t["to-scene"])&&e.send("SetCurrentTransition",{"transition-name":"Courbes"})}))}),[]),null}function V({children:e}){const t={"--columns":l.Children.toArray(e).length.toString()};return l.createElement("div",{className:"buttons",style:t},e)}function q({children:e}){return l.createElement("div",{className:"row"},e)}function G(){const e=j(),[t,n]=l.useState(!0);return l.useEffect((()=>{const t=e.on("Exiting",(()=>{n(!1)})),r=e.on("Error",(()=>{n(!1)}));return()=>{t(),r()}}),[]),t?null:l.createElement("div",{className:"modal"},l.createElement("p",null,"La connexion avec le serveur de websocket a Ã©tÃ© perdue"),l.createElement("button",{className:"button",onClick:()=>{window.location.reload()}},l.createElement(L,{name:P.refresh}),"Rafraichir la page"))}const H=new URL(window.location.href),J=H.searchParams.get("host")||"192.168.0.50:4444",W=H.searchParams.get("password")||"";g.render(l.createElement(l.StrictMode,null,l.createElement(N,{hostname:J,password:W},l.createElement(O,null,l.createElement(q,null,l.createElement(F,null)),l.createElement(q,null,l.createElement(I,{scene:"ðŸ“¦ Tchat"},l.createElement(L,{name:P.tchat}),l.createElement("span",null,"Tchat")),l.createElement(V,null,l.createElement(_,{scene:"Stream",filter:"zoom"},l.createElement(L,{name:P.zoom}),l.createElement("span",null,"Zoomer")),l.createElement(_,{scene:"Stream",filter:"left"},l.createElement(L,{name:P.left}),l.createElement("span",null,"Ã€ gauche")),l.createElement(_,{scene:"Stream",filter:"default"},l.createElement(L,{name:P.right}),l.createElement("span",null,"Ã€ droite")))),l.createElement(q,null,l.createElement(z,{scene:"Stream",group:"Sounds"})),l.createElement(q,null,l.createElement(z,{scene:"Stream",group:"Music",icon:P.music})),l.createElement(B,null)),l.createElement(G,null))),document.getElementById("root"));
