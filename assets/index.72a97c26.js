var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,a=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(n)for(var l of n(a))r.call(a,l)&&s(e,l,a[l]);return e};import{j as l,r as c,I as o,a as u,b as i,c as m,d,e as f,f as E,g as p,h,i as g,k as w}from"./vendor.0ba4a177.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const r=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,a)=>{const l=new URL(e,r);if(self[t].moduleMap[l])return n(self[t].moduleMap[l]);const c=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){a(new Error(`Failed to import: ${e}`)),s(o)},onload(){n(self[t].moduleMap[l]),s(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("assets/");var b,v;function S(e){const t=new l("SHA-256","TEXT");return t.update(e),t.getHash("BYTES")}(v=b||(b={})).OK="ok",v.ERROR="error";let y=1;class C extends class{constructor(){this.listeners={}}on(e,t){const n=this.listeners[e]||[];return this.listeners[e]=[...n,t],()=>{this.off(e,t)}}off(e,t){const n=this.listeners[e]||[];this.listeners[e]=n.filter((e=>e!==t))}emit(e,t){(this.listeners[e]||[]).forEach((e=>e(t)))}destroy(){this.listeners={}}}{constructor(){super(...arguments),this.messageCallbacks={}}connect(e="localhost:4444",t=""){const n=this;return new Promise((function(r,s){n.ws=new WebSocket(`ws://${e}`),n.ws.onopen=()=>{n.send("GetAuthRequired",{},(function(e){const a=t+e.salt,l=btoa(S(a)),c=btoa(S(l+e.challenge));n.send("Authenticate",{auth:c},(e=>{e.status===b.ERROR&&s(e.error),r()}))}))},n.ws.onerror=e=>{s(e),n.emit("Error",e)},n.ws.onmessage=e=>{const t=JSON.parse(e.data),r=n.messageCallbacks[t["message-id"]];r&&r(t),t["update-type"]&&n.emit(t["update-type"],t)}}))}on(e,t){return super.on(e,t)}send(e,t,n){const r=y++;n&&(this.messageCallbacks[r]=n),this.ws.send(JSON.stringify(a({"request-type":e,"message-id":r.toString()},t)))}close(){this.ws.close()}destroy(){this.close(),super.destroy()}}var R,N;function j({name:e}){switch(e){case R.scene:return c.createElement(g,null);case R.sound:return c.createElement(h,null);case R.music:return c.createElement(p,null);case R.tchat:return c.createElement(E,null);case R.zoom:return c.createElement(f,null);case R.left:return c.createElement(d,null);case R.right:return c.createElement(m,null);case R.camera:return c.createElement(i,null);case R.refresh:return c.createElement(u,null);case R.image:return c.createElement(o,null)}return null}(N=R||(R={})).scene="scene",N.sound="sound",N.music="music",N.tchat="tchat",N.zoom="zoom",N.left="left",N.right="right",N.camera="camera",N.refresh="refresh",N.image="image";const k=c.createContext({scenes:[],obsRef:{current:new C},currentScene:""});function O(e,t){var n,r;let s=(null==(n=function(e){return c.useContext(k).scenes.find((t=>t.name===e))}(e))?void 0:n.sources)||[];return t&&(s=(null==(r=s.find((e=>e.name===t)))?void 0:r.groupChildren)||[]),s}function x(){return c.useContext(k).obsRef.current}function L({children:e,hostname:t,password:n}){const[r,s]=c.useState([]),[a,l]=c.useState(""),o=c.useRef(new C),[u,i]=c.useState(null);return c.useEffect((function(){const e=o.current,r=e=>{l(e["scene-name"])},a=()=>{i(null),e.connect(t,n).then((()=>{e.send("GetSceneList",{},(e=>{s(e.scenes),l(e["current-scene"])}))})).catch((e=>{i(e)}))},c=()=>{e.close()};return a(),window.addEventListener("focus",a),window.addEventListener("blur",c),e.on("SwitchScenes",r),()=>{e.off("SwitchScenes",r),window.removeEventListener("focus",a),window.removeEventListener("blur",c)}}),[]),c.createElement(k.Provider,{value:{scenes:r,obsRef:o,currentScene:a}},u&&c.createElement(P,{hostname:t,password:n,error:`${u}`}),e)}function P({hostname:e,password:t,error:n}){return c.createElement("form",{className:"modal",onSubmit:e=>{e.preventDefault();const t=new FormData(e.target);window.location.href=`${window.location.pathname}?hostname=${t.get("hostname")}&password=${t.get("password")}`}},c.createElement("p",null,"La connexion a Ã©chouÃ©e ",c.createElement("br",null),c.createElement("small",null,n)),c.createElement("div",{className:"spaced"},c.createElement("input",{type:"text",placeholder:"HÃ´te : 192.168.0.X",defaultValue:e,name:"hostname"}),c.createElement("input",{type:"text",placeholder:"Mot de passe",defaultValue:t,name:"password"}),c.createElement("button",{className:"button"},c.createElement(j,{name:R.refresh}),"Se reconnecter")))}function M({children:e}){return c.createElement("div",{className:"grid"},e)}var $,F;function T(e){var{color:s=$.grey,children:l}=e,o=((e,s)=>{var a={};for(var l in e)t.call(e,l)&&s.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&n)for(var l of n(e))s.indexOf(l)<0&&r.call(e,l)&&(a[l]=e[l]);return a})(e,["color","children"]);const u=s!==$.grey?{background:`var(--${s})`}:void 0;return c.createElement("button",a({className:`button is-${s}`,style:u},o),l)}function U({ignore:e="ðŸ“¦"}){const t=c.useContext(k).scenes;return c.createElement(c.Fragment,null,t.filter((t=>!t.name.startsWith(e))).map((e=>c.createElement(z,{key:e.name,scene:e.name}))))}function z({scene:e}){const t=c.useContext(k).currentScene,n=x();return c.createElement(T,{color:t===e?$.blue:void 0,onClick:()=>{n.send("SetCurrentScene",{"scene-name":e})}},c.createElement(j,{name:R.scene}),c.createElement("span",null,e))}(F=$||($={})).blue="blue",F.red="red",F.yellow="yellow",F.purple="purple",F.green="green",F.grey="grey";const A={"C'est nul":"assets/cest-nul.3d0c5824.jpg",Travail:"assets/travail.5d4d612e.jpg","Travail termine":"assets/travail.5d4d612e.jpg","ah !":"assets/denis.00354ae5.jpg",sad:"assets/sad.29e5cf6c.jpg",Ascenseur:"assets/elevator.ca4ce089.jpg"};function I({scene:e,group:t,icon:n}){const r=O(e,t);return c.createElement(c.Fragment,null,r.map((e=>c.createElement(V,{name:e.name,key:e.name,icon:n}))))}function V({name:e,icon:t=R.sound}){const n=x(),[r,s]=c.useState(!1);c.useEffect((()=>{const t=n.on("MediaRestarted",(t=>{t.sourceName===e&&s(!0)})),r=n.on("MediaEnded",(t=>{t.sourceName===e&&(s(!1),n.send("SetSceneItemProperties",{item:e,visible:!1}))}));return()=>{t(),r()}}));const a=A[e];return c.createElement(T,{color:r?$.green:$.purple,onClick:()=>{n.send("SetSceneItemProperties",{item:e,visible:!r})}},c.createElement(j,{name:t}),c.createElement("span",null,e),c.createElement("img",{src:a,alt:""}))}function _({scene:e,filters:t=["show","hide"],children:n,colors:r=[$.blue,$.grey]}){const[s,a]=c.useState(0),l=x();return c.createElement(T,{color:r[s],onClick:()=>{const n=s+1>=t.length?0:s+1;l.send("SetSourceFilterVisibility",{sourceName:e,filterName:t[n],filterEnabled:!0}),a(n)}},n)}function B({scene:e,filter:t,children:n}){const r=x(),[s,a]=c.useState(!1);return c.useEffect((()=>r.on("SourceFilterVisibilityChanged",(n=>{n.sourceName===e&&n.filterEnabled&&a(n.filterName===t)}))),[t]),c.createElement(T,{color:s?$.green:$.blue,onClick:()=>{r.send("SetSourceFilterVisibility",{sourceName:e,filterName:t,filterEnabled:!s})}},n)}function H(){const e=x();return c.useEffect((()=>{e.on("TransitionEnd",(t=>{"Stream"===t["to-scene"]?e.send("SetCurrentTransition",{"transition-name":"Move"}):["Soon","Pause",""].includes(t["to-scene"])&&e.send("SetCurrentTransition",{"transition-name":"Courbes"})}))}),[]),null}function q({children:e}){const t={"--columns":c.Children.toArray(e).length.toString()};return c.createElement("div",{className:"buttons",style:t},e)}function D({children:e}){return c.createElement("div",{className:"row"},e)}function G(){const e=x(),[t,n]=c.useState(!0);return c.useEffect((()=>{const t=e.on("Exiting",(()=>{n(!1)})),r=e.on("Error",(()=>{n(!1)}));return()=>{t(),r()}}),[]),t?null:c.createElement("div",{className:"modal"},c.createElement("p",null,"La connexion avec le serveur de websocket a Ã©tÃ© perdue"),c.createElement("button",{className:"button",onClick:()=>{window.location.reload()}},c.createElement(j,{name:R.refresh}),"Rafraichir la page"))}const J=new URL(window.location.href),W=J.searchParams.get("host")||"192.168.0.50:4444",X=J.searchParams.get("password")||"";w.render(c.createElement(c.StrictMode,null,c.createElement(L,{hostname:W,password:X},c.createElement(M,null,c.createElement(D,null,c.createElement(U,null)),c.createElement(D,null,c.createElement(_,{scene:"Preview"},c.createElement(j,{name:R.image}),c.createElement("span",null,"Preview")),c.createElement(q,null,c.createElement(B,{scene:"Stream",filter:"zoom"},c.createElement(j,{name:R.zoom}),c.createElement("span",null,"Zoomer")),c.createElement(B,{scene:"Stream",filter:"left"},c.createElement(j,{name:R.left}),c.createElement("span",null,"Ã€ gauche")),c.createElement(B,{scene:"Stream",filter:"default"},c.createElement(j,{name:R.right}),c.createElement("span",null,"Ã€ droite")))),c.createElement(D,null,c.createElement(I,{scene:"Stream",group:"Sounds"})),c.createElement(D,null,c.createElement(I,{scene:"Stream",group:"Music",icon:R.music})),c.createElement(H,null)),c.createElement(G,null))),document.getElementById("root"));
